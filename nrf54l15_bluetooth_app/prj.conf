#===============================================================================
# nRF54L15 蓝牙应用 + Shell + 日志完整配置
# 基于你提供的工作配置进行扩展
#===============================================================================

#-------------------------------------------------------------------------------
# GPIO和硬件驱动
#-------------------------------------------------------------------------------
CONFIG_GPIO=y

#-------------------------------------------------------------------------------
# 串口系统配置
#-------------------------------------------------------------------------------
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
CONFIG_UART_ASYNC_API=y

#-------------------------------------------------------------------------------
# Shell系统配置
#-------------------------------------------------------------------------------
CONFIG_SHELL=y
CONFIG_SHELL_BACKENDS=y
CONFIG_SHELL_BACKEND_SERIAL=y
CONFIG_KERNEL_SHELL=y

# Shell缓冲区和历史配置
CONFIG_SHELL_ARGC_MAX=20
CONFIG_SHELL_CMD_BUFF_SIZE=256
CONFIG_SHELL_PRINTF_BUFF_SIZE=256
CONFIG_SHELL_HISTORY=y
CONFIG_SHELL_HISTORY_BUFFER=512

#-------------------------------------------------------------------------------
# 日志系统配置
#-------------------------------------------------------------------------------
CONFIG_LOG=y
CONFIG_LOG_MODE_DEFERRED=y
CONFIG_LOG_BACKEND_UART=y
CONFIG_LOG_PRINTK=y
CONFIG_LOG_BUFFER_SIZE=4096
CONFIG_LOG_DEFAULT_LEVEL=3

# 禁用RTT（避免冲突）
CONFIG_USE_SEGGER_RTT=n
CONFIG_RTT_CONSOLE=n
CONFIG_LOG_BACKEND_RTT=n

#-------------------------------------------------------------------------------
# C库配置
#-------------------------------------------------------------------------------
CONFIG_NEWLIB_LIBC=y
CONFIG_NEWLIB_LIBC_FLOAT_PRINTF=y

#-------------------------------------------------------------------------------
# 系统配置
#-------------------------------------------------------------------------------
CONFIG_MAIN_STACK_SIZE=2048
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_LOG_PROCESS_THREAD_STACK_SIZE=1024
CONFIG_SHELL_STACK_SIZE=4096
CONFIG_HEAP_MEM_POOL_SIZE=4096

#-------------------------------------------------------------------------------
# 调试配置
#-------------------------------------------------------------------------------
CONFIG_DEBUG=y
CONFIG_DEBUG_INFO=y
CONFIG_ASSERT=y
CONFIG_RESET_ON_FATAL_ERROR=n

#-------------------------------------------------------------------------------
# Shell命令扩展
#-------------------------------------------------------------------------------
CONFIG_DEVICE_SHELL=y
CONFIG_DEVMEM_SHELL=y
CONFIG_KERNEL_SHELL=y
CONFIG_LOG_CMDS=y

#-------------------------------------------------------------------------------
# 蓝牙基础配置
#-------------------------------------------------------------------------------
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="nRF54L15_BT_Shell"

# 连接参数
CONFIG_BT_MAX_CONN=1
CONFIG_BT_MAX_PAIRED=1

# GAP 配置
CONFIG_BT_GAP_PERIPHERAL_PREF_PARAMS=y
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=20
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=40
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=42

#-------------------------------------------------------------------------------
# 蓝牙GATT配置
#-------------------------------------------------------------------------------
CONFIG_BT_GATT_DYNAMIC_DB=y
CONFIG_BT_GATT_CACHING=y
CONFIG_BT_GATT_SERVICE_CHANGED=y

# ATT MTU设置
CONFIG_BT_L2CAP_TX_MTU=247
CONFIG_BT_BUF_ACL_RX_SIZE=251
CONFIG_BT_BUF_ACL_TX_SIZE=251

#-------------------------------------------------------------------------------
# Nordic UART Service (NUS) 配置
#-------------------------------------------------------------------------------
CONFIG_BT_NUS=y

#-------------------------------------------------------------------------------
# 蓝牙安全和配对
#-------------------------------------------------------------------------------
CONFIG_BT_SMP=y
CONFIG_BT_SETTINGS=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_NVS=y
CONFIG_SETTINGS=y

# 安全级别
CONFIG_BT_SMP_SC_PAIR_ONLY=y
CONFIG_BT_SMP_APP_PAIRING_ACCEPT=y

# 绑定存储
CONFIG_BT_SETTINGS_CCC_STORE_ON_WRITE=y

#-------------------------------------------------------------------------------
# DK按键LED库
#-------------------------------------------------------------------------------
CONFIG_DK_LIBRARY=y

#-------------------------------------------------------------------------------
# 内存和缓冲区优化
#-------------------------------------------------------------------------------
CONFIG_BT_BUF_EVT_RX_SIZE=255
CONFIG_BT_BUF_EVT_DISCARDABLE_SIZE=255
CONFIG_BT_BUF_EVT_DISCARDABLE_COUNT=3
CONFIG_BT_BUF_CMD_TX_SIZE=255

# HCI缓冲区
CONFIG_BT_BUF_ACL_TX_COUNT=3
CONFIG_BT_BUF_ACL_RX_COUNT=6

# GATT缓冲区
CONFIG_BT_ATT_PREPARE_COUNT=0

#-------------------------------------------------------------------------------
# 多线程支持
#-------------------------------------------------------------------------------
CONFIG_MULTITHREADING=y

#-------------------------------------------------------------------------------
# 蓝牙Shell命令支持 (可选)
#-------------------------------------------------------------------------------
# CONFIG_BT_SHELL=y